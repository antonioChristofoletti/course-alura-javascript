{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","_ordemAtual","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_mensagemView","MensagemView","_negociacaoView","NegociacaoView","_negociacaoLista","Bind","NegociacaoLista","_mensagem","Mensagem","_init","setInterval","_carregarLista","addedNegociacaoLista","negociacaoLista","NegociacaoService","getNegociacaoList","then","addAll","texto","catch","erro","evento","preventDefault","newNegociacao","_criarNegociacao","adicionar","add","_limparCampos","mensagem","Negociacao","DataHelper","textoParaData","value","parseInt","focus","promise","Promise","all","getWeeklyNegociacoes","getLastWeekNegociacoes","getRetreatedWeekNegociacoes","negociacoeslist","response","reduce","concatList","iterationList","concat","console","error","rejection","coluna","ordenaReversa","ordena","a","b","removeNegociacaoAll","removeAll"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;IAEaA,oB,WAAAA,oB;AAET,oCAAc;AAAA;;AACV,aAAKC,WAAL,GAAmB,EAAnB;;AAEA,YAAMC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAV;;AAEA,aAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,aAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,aAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;;AAEA,aAAKO,aAAL,GAAqB,IAAIC,0BAAJ,CAAiBR,EAAE,eAAF,CAAjB,CAArB;AACA,aAAKS,eAAL,GAAuB,IAAIC,8BAAJ,CAAmBV,EAAE,iBAAF,CAAnB,CAAvB;;AAEA,aAAKW,gBAAL,GAAwB,IAAIC,UAAJ,CAAS,IAAIC,gCAAJ,EAAT,EAAgC,KAAKJ,eAArC,EAAsD,QAAtD,EAAgE,KAAhE,EAAuE,WAAvE,EAAoF,QAApF,EAA8F,eAA9F,CAAxB;;AAEA,aAAKK,SAAL,GAAiB,IAAIF,UAAJ,CAAS,IAAIG,kBAAJ,EAAT,EAAyB,KAAKR,aAA9B,EAA6C,OAA7C,CAAjB;;AAEA,aAAKS,KAAL;AACH;;;;gCAEO;AAAA;;AACJC,wBAAY;AAAA,uBAAK,MAAKC,cAAL,EAAL;AAAA,aAAZ,EAAwC,IAAxC;AACH;;;yCAEgB;AAAA;;AACb,gBAAMC,uBAAuB,KAAKR,gBAAL,CAAsBS,eAAnD;;AAEAC,iDACKC,iBADL,CACuBH,oBADvB,EAEKI,IAFL,CAEU,2BAAmB;AACrB,uBAAKZ,gBAAL,CAAsBa,MAAtB,CAA6BJ,eAA7B;AACA,uBAAKN,SAAL,CAAeW,KAAf,GAAuB,kCAAvB;AACH,aALL,EAMKC,KANL,CAMW;AAAA,uBAAQ,OAAKZ,SAAL,CAAeW,KAAf,GAAuBE,IAA/B;AAAA,aANX;AAOH;;;kCAESC,M,EAAQ;AAAA;;AACdA,mBAAOC,cAAP;;AAEA,gBAAMC,gBAAgB,KAAKC,gBAAL,EAAtB;;AAEAV,iDACKW,SADL,CACeF,aADf,EAEKP,IAFL,CAEU,oBAAY;AACd,uBAAKZ,gBAAL,CAAsBsB,GAAtB,CAA0BH,aAA1B;AACA,uBAAKI,aAAL;;AAEA,uBAAKpB,SAAL,CAAeW,KAAf,GAAuBU,QAAvB;AACH,aAPL,EAQKT,KARL,CAQW;AAAA,uBAAQ,OAAKZ,SAAL,CAAeW,KAAf,GAAuBE,IAA/B;AAAA,aARX;AASH;;;2CAEkB;AACf,mBAAO,IAAIS,sBAAJ,CACHC,uBAAWC,aAAX,CAAyB,KAAKlC,UAAL,CAAgBmC,KAAzC,CADG,EAEHC,SAAS,KAAKnC,gBAAL,CAAsBkC,KAA/B,CAFG,EAGHC,SAAS,KAAKlC,WAAL,CAAiBiC,KAA1B,CAHG,CAAP;AAKH;;;wCAEe;AACZ,iBAAKnC,UAAL,CAAgBmC,KAAhB,GAAwB,EAAxB;AACA,iBAAKlC,gBAAL,CAAsBkC,KAAtB,GAA8B,EAA9B;AACA,iBAAKjC,WAAL,CAAiBiC,KAAjB,GAAyB,EAAzB;AACA,iBAAKnC,UAAL,CAAgBqC,KAAhB;AACH;;;8CAEqB;AAAA;;AAClB,gBAAMC,UAAUC,QAAQC,GAAR,CAAY,CACxBvB,qCAAkBwB,oBAAlB,EADwB,EAExBxB,qCAAkByB,sBAAlB,EAFwB,EAGxBzB,qCAAkB0B,2BAAlB,EAHwB,CAAZ,CAAhB;;AAKAL,oBACKnB,IADL,CACU,oBAAY;AACd,oBAAMyB,kBAAkBC,SAASC,MAAT,CAAgB,UAACC,UAAD,EAAaC,aAAb;AAAA,2BAA+BD,WAAWE,MAAX,CAAkBD,aAAlB,CAA/B;AAAA,iBAAhB,EAAiF,EAAjF,CAAxB;;AAEA,uBAAKzC,gBAAL,CAAsBa,MAAtB,CAA6BwB,eAA7B;AACA,uBAAKlC,SAAL,CAAeW,KAAf,GAAuB,8BAAvB;AACH,aANL,EAOKC,KAPL,CAOW,qBAAa;AAChB4B,wBAAQC,KAAR,gDAA2DC,SAA3D;AACA,uBAAK1C,SAAL,CAAeW,KAAf,GAAuB,sCAAvB;AACH,aAVL;AAWH;;;+BAEMgC,M,EAAQ;AACX,gBAAI,KAAK1D,WAAL,KAAqB0D,MAAzB,EAAiC;AAC7B,qBAAK9C,gBAAL,CAAsB+C,aAAtB;AACH,aAFD,MAEO;AACH,qBAAK/C,gBAAL,CAAsBgD,MAAtB,CAA6B,UAACC,CAAD,EAAIC,CAAJ;AAAA,2BAAUD,EAAEH,MAAF,IAAYI,EAAEJ,MAAF,CAAtB;AAAA,iBAA7B;AACA,qBAAK1D,WAAL,GAAmB0D,MAAnB;AACH;AACJ;;;8CAEqB;AAAA;;AAClBpC,iDACKyC,mBADL,GAEKvC,IAFL,CAEU,oBAAY;AACd,uBAAKZ,gBAAL,CAAsBoD,SAAtB;AACA,uBAAKjD,SAAL,CAAeW,KAAf,GAAuBU,QAAvB;AACH,aALL,EAMKT,KANL,CAMW;AAAA,uBAAQ,OAAKZ,SAAL,CAAeW,KAAf,GAAuBE,IAA/B;AAAA,aANX;AAOH","file":"NegociacaoController.js","sourcesContent":["import { MensagemView } from \"../view/MensagemView\";\nimport { NegociacaoView } from \"../view/NegociacaoView\";\nimport { NegociacaoLista } from \"./NegociacaoLista\";\nimport { Mensagem } from \"../models/Mensagem\";\nimport { Bind } from \"../models/Bind\";\nimport { Negociacao } from \"../models/Negociacao\";\nimport { NegociacaoService } from \"../services/NegociacaoService\";\nimport { DataHelper } from \"../helpers/DataHelper\";\n\nexport class NegociacaoController {\n\n    constructor() {\n        this._ordemAtual = '';\n\n        const $ = document.querySelector.bind(document)\n\n        this._inputData = $(\"#data\")\n        this._inputQuantidade = $(\"#quantidade\")\n        this._inputValor = $(\"#valor\")\n\n        this._mensagemView = new MensagemView($(\"#mensagemView\"))\n        this._negociacaoView = new NegociacaoView($(\"#negociacaoView\"))\n\n        this._negociacaoLista = new Bind(new NegociacaoLista(), this._negociacaoView, \"addAll\", \"add\", \"removeAll\", \"ordena\", \"ordenaReversa\")\n\n        this._mensagem = new Bind(new Mensagem(), this._mensagemView, \"texto\")\n\n        this._init()\n    }\n\n    _init() {\n        setInterval(_ => this._carregarLista(), 3000)\n    }\n\n    _carregarLista() {\n        const addedNegociacaoLista = this._negociacaoLista.negociacaoLista\n\n        NegociacaoService\n            .getNegociacaoList(addedNegociacaoLista)\n            .then(negociacaoLista => {\n                this._negociacaoLista.addAll(negociacaoLista)\n                this._mensagem.texto = \"Elementos carregados com sucesso\"\n            })\n            .catch(erro => this._mensagem.texto = erro)\n    }\n\n    adicionar(evento) {\n        evento.preventDefault()\n\n        const newNegociacao = this._criarNegociacao()\n\n        NegociacaoService\n            .adicionar(newNegociacao)\n            .then(mensagem => {\n                this._negociacaoLista.add(newNegociacao)\n                this._limparCampos()\n\n                this._mensagem.texto = mensagem\n            })\n            .catch(erro => this._mensagem.texto = erro)\n    }\n\n    _criarNegociacao() {\n        return new Negociacao(\n            DataHelper.textoParaData(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseInt(this._inputValor.value)\n        )\n    }\n\n    _limparCampos() {\n        this._inputData.value = \"\"\n        this._inputQuantidade.value = \"\"\n        this._inputValor.value = \"\"\n        this._inputData.focus()\n    }\n\n    carregarNegociacoes() {\n        const promise = Promise.all([\n            NegociacaoService.getWeeklyNegociacoes(),\n            NegociacaoService.getLastWeekNegociacoes(),\n            NegociacaoService.getRetreatedWeekNegociacoes()])\n\n        promise\n            .then(response => {\n                const negociacoeslist = response.reduce((concatList, iterationList) => concatList.concat(iterationList), [])\n\n                this._negociacaoLista.addAll(negociacoeslist)\n                this._mensagem.texto = \"Lista atualizada com sucesso\"\n            })\n            .catch(rejection => {\n                console.error(`Error getting the negociacao list. Error: ${rejection}`)\n                this._mensagem.texto = \"Erro ao obter a lista de negociacoes\"\n            })\n    }\n\n    ordena(coluna) {\n        if (this._ordemAtual === coluna) {\n            this._negociacaoLista.ordenaReversa()\n        } else {\n            this._negociacaoLista.ordena((a, b) => a[coluna] - b[coluna])\n            this._ordemAtual = coluna\n        }\n    }\n\n    removeNegociacaoAll() {\n        NegociacaoService\n            .removeNegociacaoAll()\n            .then(mensagem => {\n                this._negociacaoLista.removeAll()\n                this._mensagem.texto = mensagem\n            })\n            .catch(erro => this._mensagem.texto = erro)\n    }\n}"]}